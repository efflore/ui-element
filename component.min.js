const t=t=>e=>typeof e===t,e=t=>null!=t,s=t("object"),n=t("function"),r=t=>e(t)&&(s(t)||n(t)),o=t=>t.nodeType!==Node.COMMENT_NODE,c=Symbol("nothing"),a=t=>n(t)?a(t()):t,i=(t,e)=>t&&n(t[e]),l=t=>(t=>(t=>null==t)(t)||n(t)&&"type"in t&&t.type===c)(t)?d():u(t),u=t=>{const e=()=>t;return e.type=typeof t,e.toString=()=>r(t)?JSON.stringify(t):String(t),e.map=e=>l(e(t)),e.or=()=>u(t),e},d=()=>new Proxy((()=>{}),{get:(t,e)=>"type"===e?c:"toString"===e?()=>"":"or"===e?t=>l(t()):()=>d()});let p;const h=t=>n(t)&&i(t,"set"),f=t=>h(t)||(t=>n(t)&&i(t,"run")&&"effects"in t)(t),b=t=>{const e=()=>(p&&e.effects.add(p),t);return e.effects=new Set,e.set=s=>{const o=t;t=n(s)&&!f(s)?(t=>r(t)&&i(t,"map"))(t)?t.map(s):s(t):s,!Object.is(a(t),a(o))&&(t=>{for(const e of t)e.run()})(e.effects)},e},m=t=>{const e=new Map,s=()=>{const r=p;p=s;const o=t(((t,s)=>{!e.has(t)&&e.set(t,new Set),e.get(t)?.add(s)}));for(const t of e.values()){for(const e of t)e();t.clear()}p=r,n(o)&&queueMicrotask(o)};s.run=()=>s(),s.targets=e,s()},g="context-request";class y extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(g,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}class x extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)||this.registry.define(t,this)}catch(t){console.error(t)}}#t=new Map;attributeChangedCallback(t,e,s){if(s===e)return;const r=this.constructor.attributeMap[t],o=l(s);this.set(t,n(r)?r(o,this,e):o)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new y(t,(e=>this.set(String(t),e))))}));const s=t.providedContexts||[];s.length&&this.addEventListener(g,(t=>{const{context:e,callback:r}=t;s.includes(e)&&n(r)&&(t.stopPropagation(),r(this.#t.get(String(e))))}))}has(t){return this.#t.has(t)}get(t){return a(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);h(s)&&s.set(e)}}else this.#t.set(t,f(e)?e:b(e))}delete(t){return this.#t.delete(t)}async pass(t,e){if(await this.constructor.registry.whenDefined(t.localName),!i(t,"set"))throw new TypeError("Expected UIElement");for(const[s,r]of Object.entries(e))t.set(s,f(r)?r:n(r)?b(r):this.#t.get(r))}signal(t){return this.#t.get(t)}}const v=t=>Number.isFinite(t)?t:void 0,C=t=>t.map((()=>!0)).or((()=>!1)),E=t=>t.map((t=>v(parseInt(t,10)))),S=t=>t.map((t=>v(parseFloat(t)))),M=t=>t,k=t=>t.map((t=>{let e;try{e=JSON.parse(t)}catch(t){console.error(t)}return e})),w=(t,s)=>{const n=()=>t;n.map=e=>w(e(t,s),s),n.on=(e,s)=>(t.addEventListener(e,s),()=>t.removeEventListener(e,s));const r=(e,r,o)=>(s.set(e,r,!1),m((n=>s.has(e)&&n(t,(()=>o(s.get(e),r))))),n);if(n.text=s=>r(s,t.textContent||"",((s,n)=>{Array.from(t.childNodes).filter(o).forEach((t=>t.remove())),t.append(document.createTextNode(e(s)?s:n))})),n.prop=(e,s=e)=>r(s,t[e],(s=>t[e]=s)),n.attr=(s,n=s)=>r(n,t.getAttribute(s),(n=>e(n)?t.setAttribute(s,String(n)):t.removeAttribute(s))),n.bool=(e,s=e)=>r(s,t.hasAttribute(e),(s=>t.toggleAttribute(e,s))),n.class=(e,s=e)=>r(s,t.classList.contains(e),(s=>t.classList[s?"add":"remove"](e))),(t=>{for(const e of[HTMLElement,SVGElement,MathMLElement])if(t instanceof e)return!0;return!1})(t)&&(n.style=(s,n=s)=>r(n,t.style[s],(n=>e(n)?t.style[s]=String(n):t.style.removeProperty(s)))),s===t){const t=s.shadowRoot||s;n.first=e=>{const n=t.querySelector(e);return n?w(n,s):d()},n.all=e=>Array.from(t.querySelectorAll(e)).map((t=>w(t,s)))}return n},A=(t,e={},s,o=x)=>{const c=class extends o{static observedAttributes=r(e.attributeMap)?Object.keys(e.attributeMap):[];static attributeMap=e.attributeMap||{};static providedContexts=e.providedContexts||[];static consumedContexts=e.consumedContexts||[];connectedCallback(){if(super.connectedCallback(),!n(s))return;const t=s(this,w(this,this));n(t)&&(this.disconnectedCallback=()=>{super.disconnectedCallback(),t()})}};return c.define(t),c};export{C as asBoolean,E as asInteger,k as asJSON,S as asNumber,M as asString,A as component,x as default,m as effect,l as maybe,w as ui};