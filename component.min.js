const t=t=>e=>typeof e===t,e=t=>null!=t,s=t("string"),n=t("object"),r=t("function"),o=t=>t.nodeType!==Node.COMMENT_NODE,c="nothing",a=t=>r(t)?a(t()):t,i=t=>r(t)&&"type"in t,l=(t,e)=>t&&r(t[e]),u=t=>(t=>null==t)(t)||((t,e)=>i(e)&&e.type===t)(c,t),d=t=>u(t)?h():f(t),f=t=>{const e=()=>t;return e.type=typeof t,e.or=e=>t,e.map=e=>d(e(t)),e.chain=e=>e(t),e.filter=e=>e(t)?f(t):h(),e},h=()=>new Proxy((()=>{}),{get:(t,e)=>{switch(e){case"type":return c;case"toString":return()=>"";case"or":return t=>t;case"chain":return t=>t();default:return()=>h()}}});let p;const b=t=>r(t)&&l(t,"set"),m=t=>b(t)||(t=>r(t)&&l(t,"run")&&"effects"in t)(t),g=t=>{const e=()=>(p&&e.effects.add(p),t);return e.effects=new Set,e.set=s=>{const n=t;t=r(s)&&!m(s)?(t=>i(t)&&l(t,"map"))(t)?t.map(s):s(t):s,!Object.is(a(t),a(n))&&(t=>{for(const e of t)e.run()})(e.effects)},e},y=t=>{const e=new Map,s=()=>{const n=p;p=s;const o=t(((t,s)=>{!e.has(t)&&e.set(t,new Set),e.get(t)?.add(s)}));for(const t of e.values()){for(const e of t)e();t.clear()}p=n,r(o)&&queueMicrotask(o)};s.run=()=>s(),s.targets=e,s()},x="context-request";class v extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(x,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}class C extends HTMLElement{static consumedContexts;static providedContexts;static define(t,e=customElements){try{e.get(t)||e.define(t,this)}catch(t){console.error(t)}}attributeMap={};#t=new Map;attributeChangedCallback(t,e,s){if(s===e)return;const n=this.attributeMap[t],o=d(s);this.set(t,r(n)?o.map((t=>n(t,this,e))):o)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new v(t,(e=>this.set(String(t),e))))}));const s=t.providedContexts||[];s.length&&this.addEventListener(x,(t=>{const{context:e,callback:n}=t;s.includes(e)&&r(n)&&(t.stopPropagation(),n(this.#t.get(String(e))))}))}has(t){return this.#t.has(t)}get(t){return a(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);b(s)&&s.set(e)}}else this.#t.set(t,m(e)?e:g(e))}delete(t){return this.#t.delete(t)}async pass(t,e,s=customElements){if(await s.whenDefined(t.localName),!l(t,"set"))throw new TypeError("Expected UIElement");for(const[s,n]of Object.entries(e))t.set(s,m(n)?n:r(n)?g(n):this.#t.get(n))}signal(t){return this.#t.get(t)}}const E=t=>Number.isFinite(t)?t:void 0,M=t=>s(t),S=t=>E(parseInt(t,10)),k=t=>E(parseFloat(t)),w=t=>e(t)?t:void 0,A=t=>{let e;try{e=JSON.parse(t)}catch(t){console.error(t),e=void 0}return e},L=(t,s=t)=>{const n=()=>s;n.map=e=>L(t,e(t,s)),n.chain=e=>e(t,s),n.filter=e=>e(t,s)?L(t,s):h(),n.on=(t,e)=>(s.addEventListener(t,e),n),n.off=(t,e)=>(s.removeEventListener(t,e),n);const r=(e,r,o)=>(t.set(e,r,!1),y((n=>t.has(e)&&n(s,(()=>o(t.get(e),r))))),n);if(n.text=t=>r(t,s.textContent||"",((t,n)=>{Array.from(s.childNodes).filter(o).forEach((t=>t.remove())),s.append(document.createTextNode(e(t)?String(t):n))})),n.prop=(t,e=t)=>r(e,s[t],(e=>s[t]=e)),n.attr=(t,n=t)=>r(n,s.getAttribute(t),(n=>e(n)?s.setAttribute(t,String(n)):s.removeAttribute(t))),n.bool=(t,e=t)=>r(e,s.hasAttribute(t),(e=>s.toggleAttribute(t,e))),n.class=(t,e=t)=>r(e,s.classList.contains(t),(e=>s.classList[e?"add":"remove"](t))),(t=>{for(const e of[HTMLElement,SVGElement,MathMLElement])if(t instanceof e)return!0;return!1})(s)&&(n.style=(t,n=t)=>r(n,s.style[t],(n=>e(n)?s.style[t]=String(n):s.style.removeProperty(t)))),t===s){const e=t.shadowRoot||t;n.first=s=>{const n=e.querySelector(s);return n?L(t,n):h()},n.all=s=>Array.from(e.querySelectorAll(s)).map((e=>L(t,e))),n.targets=e=>{const s=[],n=t.signal(e);if(!n||!n.effects)return s;for(const e of n.effects){const n=e.targets?.keys();if(n)for(const e of n)s.push(L(t,e))}return s}}return n},N=(t,s={},r,o,c=C)=>{const a=class extends c{static observedAttributes=(t=>e(t)&&n(t))(s.attributeMap)?Object.keys(s.attributeMap):[];static providedContexts=s.providedContexts||[];static consumedContexts=s.consumedContexts||[];attributeMap=s.attributeMap||{};connectedCallback(){super.connectedCallback(),r&&r(this,L(this))}disconnectedCallback(){super.disconnectedCallback(),o&&o(this)}};return a.define(t),a};export{M as asBoolean,S as asInteger,A as asJSON,k as asNumber,w as asString,N as component,C as default,y as effect,L as ui};