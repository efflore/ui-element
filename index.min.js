const t=t=>e=>typeof e===t,e=t("string"),s=t("object"),r=t("function"),a=t=>null==t,i=t=>null!=t,n=t=>t.nodeType!==Node.COMMENT_NODE,o=t=>a(t)?[]:[t],l="warn",c="error",u=(t,e,s="debug")=>([c,l].includes(s)&&console[s](e,t),t);let d;const{enqueue:b,cleanup:h}=(()=>{const t=new Map,e=new Map;let s;const r=(t,e)=>{try{t()}catch(t){u(t,e,c)}},a=()=>{s=null,t.forEach(((t,e)=>t.forEach(((t,s)=>r(t(e),`Effect ${s} on ${e?.localName||"unknown"} failed`))))),t.clear(),e.forEach((t=>r(t,"Cleanup failed"))),e.clear()},i=t=>(e,r)=>{const i=!t.has(e);t.set(e,r),i&&(s&&cancelAnimationFrame(s),s=requestAnimationFrame(a))};return queueMicrotask(a),{enqueue:(e,s,r)=>{return i((a=e,t.has(a)||t.set(a,new Map),t.get(a)))(s,r);var a},cleanup:i(e)}})(),p=t=>{d&&t.add(d)},g=t=>t.forEach((t=>t())),m=(t,e)=>{const s=d;d=e;try{t()}catch(t){u(t,"Error during reactive computation",c)}finally{d=s}},x=t=>(t=>i(t)&&(s(t)||r(t)))(t)&&r(t["set"]),f=t=>{const e=new Set,s=()=>(p(e),t);return s.set=s=>{const a=t;t=r(s)&&s.length?s(t):s,Object.is(t,a)||g(e)},s},v=(t,e=!1)=>{const s=new Set;let r,i=!0;const n=()=>{i=!0,e&&g(s)};return()=>(p(s),e&&!i||m((()=>{r=t(),i=a(r)}),n),r)},w=t=>{const e=()=>m((()=>{const e=t(b);r(e)&&h(t,e)}),e);e()},y=(t,e,s,a=void 0)=>{const i=t.constructor.attributeMap[e];return r(i)?i(o(s),t,a)[0]:s},M=t=>[i(t[0])],A=t=>t.map((t=>parseInt(t,10))).filter(Number.isFinite),S=t=>t.map(parseFloat).filter(Number.isFinite),C=t=>t,E=t=>{let e=[];try{e=t.map((t=>JSON.parse(t)))}catch(t){u(t,"Failed to parse JSON",c)}return e},$=(t,e,s)=>{t.set(e,t.hasAttribute(e),!1),w((r=>{const a=t.internals.states.has(e),i=t.get(e);Object.is(i,a)||r(t,`i-${e}`,i?t=>()=>{t.internals.states.add(e),s&&(t.internals[s]="true",t.setAttribute(`aria-${e}`,"true")),t.toggleAttribute(e,!0)}:t=>()=>{t.internals.states.delete(e),s&&(t.internals[s]="false",t.setAttribute(`aria-${e}`,"false")),t.toggleAttribute(e,!1)})}))},k=(t,e,s)=>{t.set(e,y(t,e,t.getAttribute(e)),!1),w((r=>{const a=t.internals[s],n=String(t.get(e));n!==a&&r(t,`i-${e}`,i(n)?t=>()=>{t.internals[s]=n,t.setAttribute(`aria-${e}`,n)}:t=>()=>{t.internals[s]=void 0,t.removeAttribute(`aria-${e}`)})}))},O="context-request";class N extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(O,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const q=t=>async e=>{await e.host.constructor.registry.whenDefined(e.target.localName);for(const[s,a]of Object.entries(t))e.target.set(s,x(a)?a:r(a)?f(a):e.host.signal(a));return e},L=(t,e)=>s=>(s.target.addEventListener(t,e),s),j=(t,e)=>s=>(s.target.removeEventListener(t,e),s),P=(t,e=t)=>s=>(w((()=>{s.target.dispatchEvent(new CustomEvent(t,{detail:s.host.get(e),bubbles:!0}))})),s),R=(t,s,i,n,o,l)=>{const c=n();return r(s)||t.host.set(s,e(s)&&e(c)?y(t.host,s,c):c,!1),w((e=>{const u=n(),d=r(s)?s(u):t.host.get(s);Object.is(d,u)||e(t.target,i,l&&(t=>null===t)(d)?l:a(d)?o(c):o(d))})),t},F=t=>e=>R(e,t,"t",(()=>e.target.textContent||""),(t=>e=>()=>{Array.from(e.childNodes).filter(n).forEach((t=>t.remove())),e.append(document.createTextNode(t))})),T=(t,e=t)=>s=>R(s,e,`p-${String(t)}`,(()=>s.target[t]),(e=>s=>()=>s[t]=e)),I=(t,e=t)=>s=>R(s,e,`a-${t}`,(()=>s.target.getAttribute(t)),(e=>s=>()=>s.setAttribute(t,e)),(e=>()=>e.removeAttribute(t))),V=(t,e=t)=>s=>R(s,e,`a-${t}`,(()=>s.target.hasAttribute(t)),(e=>s=>()=>s.toggleAttribute(t,e))),D=(t,e=t)=>s=>R(s,e,`c-${t}`,(()=>s.target.classList.contains(t)),(e=>s=>()=>s.classList.toggle(t,e))),z=(t,e=t)=>s=>R(s,e,`s-${t}`,(()=>s.target.style.getPropertyValue(t)),(e=>s=>()=>s.style.setProperty(t,e)),(e=>()=>e.style.removeProperty(t)));class H extends HTMLElement{static registry=customElements;static attributeMap={};static observedAttributes;static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)||this.registry.define(t,this)}catch(e){u(t,e.message,c)}}#t=new Map;internals;self=[{host:this,target:this}];root=this.shadowRoot||this;constructor(){super(),this.internals=this.attachInternals()}attributeChangedCallback(t,e,s){s!==e&&this.set(t,y(this,t,s,e))}connectedCallback(){(t=>{const e=t.constructor,s=e.consumedContexts||[];for(const e of s)t.set(String(e),void 0,!1);setTimeout((()=>{for(const e of s)t.dispatchEvent(new N(e,(s=>t.set(String(e),s))))}));const a=e.providedContexts||[];a.length&&t.addEventListener(O,(e=>{const{context:s,callback:i}=e;a.includes(s)&&r(i)&&(e.stopPropagation(),i(t.signal(String(s))))}))})(this),(t=>{const e=t.constructor,s=(t,e)=>e.forEach((e=>{return t.set(e,(s=e).charAt(0).toUpperCase()+s.slice(1));var s})),r=t.role,a=new Map([]);s(a,["disabled","hidden"]);const i=new Map,n=new Map([["keyshortcuts","KeyShortcuts"]]);s(n,["controls","description","label"]),s(e.attributeMap.current===M?a:n,["current"]),r&&n.set("roledescription","RoleDescription"),t.hasAttribute("aria-live")&&(s(a,["atomic","busy"]),s(n,["live","relevant"])),["textbox","combobox"].includes(r)&&n.set("autocomplete","AutoComplete"),["checkbox","menuitemcheckbox","menuitemradio","radio","switch"].includes(r)&&s(e.attributeMap.checked===M?a:n,["checked"]),["table","grid","treegrid"].includes(r)&&(i.set("colcount","ColCount"),i.set("colindex","ColIndex"),i.set("colspan","ColSpan"),i.set("rowcount","RowCount"),i.set("rowindex","RowIndex"),i.set("rowspan","RowSpan")),["button","link","treeitem","grid","row","listbox","tabpanel","menuitem","combobox"].includes(r)&&s(a,["expanded"]),["button","link","menuitem","combobox","gridcell"].includes(r)&&(e.attributeMap.haspopup===M?a:n).set("haspopup","HasPopup"),["heading","treeitem","listitem"].includes(r)&&i.set("level","Level"),"dialog"===r&&a.set("modal","Modal"),"textbox"===r&&(a.set("multiline","MultiLine"),n.set("placeholder","Placeholder")),["listbox","grid","table","tree"].includes(r)&&a.set("multiselectable","MultiSelectable"),["scrollbar","slider","separator","progressbar","tabpanel"].includes(r)&&n.set("orientation","Orientation"),["listitem","treeitem"].includes(r)&&i.set("posinset","PosInSet"),["button","switch"].includes(r)&&s(e.attributeMap.pressed===M?a:n,["pressed"]),["textbox","gridcell","spinbutton"].includes(r)&&a.set("readonly","ReadOnly"),["textbox","gridcell","spinbutton","combobox","listbox"].includes(r)&&a.set("required","Required"),["gridcell","listitem","option","tab","treeitem"].includes(r)&&a.set("selected","Selected"),["listitem","treeitem","option","row","tab"].includes(r)&&i.set("setsize","SetSize"),["grid","treegrid","table"].includes(r)&&n.set("sorted","Sorted"),["range","progressbar","slider","spinbutton"].includes(r)&&(i.set("valuemax","ValueMax"),i.set("valuemin","ValueMin"),i.set("valuenow","ValueNow"),n.set("valuetext","ValueText"));for(const s of e.observedAttributes)i.has(s)?(Object.hasOwn(e.attributeMap,s)||(e.attributeMap[s]="value"===s.slice(0,5)?S:A),k(t,s,`aria${i.get(s)}`)):n.has(s)?k(t,s,`aria${n.get(s)}`):a.has(s)&&(Object.hasOwn(e.attributeMap,s)||(e.attributeMap[s]=M),$(t,s,`aria${a.get(s)}`))})(this)}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){const e=t=>r(t)?e(t()):t;return e(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);x(s)&&s.set(e)}}else this.#t.set(t,x(e)?e:f(e))}delete(t){return this.#t.delete(t)}signal(t){return this.#t.get(t)}first(t){return o(this.root.querySelector(t)).map((t=>({host:this,target:t})))}all(t){return Array.from(this.root.querySelectorAll(t)).map((t=>({host:this,target:t})))}}export{H as UIElement,M as asBoolean,A as asInteger,E as asJSON,S as asNumber,C as asString,v as derive,w as effect,P as emit,u as log,o as maybe,j as off,L as on,q as pass,I as setAttribute,T as setProperty,z as setStyle,F as setText,V as toggleAttribute,D as toggleClass};
