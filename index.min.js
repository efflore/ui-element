/**
 * @license
 * Copyright 2024 Esther Brunner
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t=t=>"function"==typeof t,e=(e,s=[],a=e)=>t(e)?e.call(...s):a;let s;const a=new WeakMap,n=t=>(!a.has(t)&&a.set(t,new Set),a.get(t));export const cause=t=>{const a={get:()=>(s&&n(a).add(s),e(t)),set:s=>{const i=e(t);t=e(s,[a,i]),!Object.is(t,i)&&n(a).forEach((t=>t()))}};return a};export const effect=e=>{const a=()=>{s=a;const n=e();t(n)&&setTimeout(n),s=null};requestAnimationFrame(a)};export default class extends HTMLElement{attributeMapping={};#t=new Map;attributeChangedCallback(t,s,a){if(a!==s){const n=this.attributeMapping[t],[i,r]=Array.isArray(n)?n:[t,n],o={boolean:t=>"string"==typeof t,integer:t=>parseInt(t,10),number:t=>parseFloat(t)},c=e(r,[this,a,s],o[r]?o[r](a):a);this.set(i,c)}}has(t){return this.#t.has(t)}get(t){return this.has(t)&&this.#t.get(t).get()}set(t,s){this.has(t)?e(this.#t.get(t).set,[this,s]):this.#t.set(t,cause(s))}}