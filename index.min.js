const t=t=>e=>typeof e===t,e=t("object"),s=t("function"),r=t=>null==t,n=t=>null!=t,o=t=>n(t)&&(e(t)||s(t)),a=(t,e)=>s(t[e]),c=t=>t.nodeType!==Node.COMMENT_NODE,i=t=>r(t)?[]:[t],l=t=>t.shadowRoot||t,u=(t,e)=>({host:t,target:e}),h="error",g=(t,e,s="debug")=>((t=>"warn"===t||t===h)(s)&&console[s](e,t),t);let d;const{enqueue:f,cleanup:p}=(()=>{const t=new Map,e=new Map;let s;const r=(t,e)=>{try{t()}catch(t){g(t,e,h)}},n=()=>{s=null;for(const[e,s]of t)for(const[t,n]of s)r(n(e),` Effect ${t} on ${e?.localName||"unknown"} failed`);t.clear();for(const t of e.values())r(t,"Cleanup failed");e.clear()},o=t=>(e,r)=>{const o=!t.has(e);t.set(e,r),o&&(s&&cancelAnimationFrame(s),s=requestAnimationFrame(n))};return queueMicrotask(n),{enqueue:(e,s,r)=>{return o((n=e,t.has(n)||t.set(n,new Map),t.get(n)))(s,r);var n},cleanup:o(e)}})(),b=t=>o(t)&&a(t,"set"),m=t=>b(t)||(t=>o(t)&&a(t,"run")&&"effects"in t)(t),y=t=>{const e=()=>(d&&e.effects.add(d),t);return e.effects=new Set,e.set=r=>{const n=t;t=s(r)&&!m(r)?r(t):r,Object.is(t,n)||(t=>{for(const e of t)e.run()})(e.effects)},e},v=t=>{const e=new Set,r=()=>{const n=d;d=r;const o=t(((t,s,r)=>{f(t,s,r),e.add(t)}));s(o)&&p(r,o),d=n};r.run=()=>r(),r.targets=e,r()},w="context-request";class x extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(w,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const E=t=>async({host:e,target:r})=>{await e.constructor.registry.whenDefined(r.localName);for(const[n,o]of Object.entries(t))r.set(n,m(o)?o:s(o)?y(o):e.signal(o));return{host:e,target:r}},C=(t,e)=>({host:s,target:r})=>(r.addEventListener(t,e),{host:s,target:r}),N=(t,e)=>({host:s,target:r})=>(r.removeEventListener(t,e),{host:s,target:r}),A=(t,e=t)=>({host:s,target:r})=>(v((()=>{r.dispatchEvent(new CustomEvent(t,{detail:s.get(e),bubbles:!0}))})),{host:s,target:r}),M=t=>[n(t[0])],S=t=>t.map((t=>parseInt(t,10))).filter(Number.isFinite),k=t=>t.map(parseFloat).filter(Number.isFinite),q=t=>t,L=t=>{let e=[];try{e=t.map((t=>JSON.parse(t)))}catch(t){g(t,"Failed to parse JSON",h)}return e},$=(t,e,n,o,a,c,i)=>(t.set(e,s(e)?e:a,!1),v((s=>{if(t.has(e)){const a=t.get(e);s(n,o,r(a)?c:i(a))}})),{host:t,target:n}),F=t=>({host:e,target:s})=>{const r=s.textContent||"",n=t=>e=>()=>{Array.from(e.childNodes).filter(c).forEach((t=>t.remove())),e.append(document.createTextNode(t))};return $(e,t,s,"t",r,n(r),n)},O=(t,e=t)=>({host:s,target:r})=>{const n=e=>s=>()=>s[t]=e;return $(s,e,r,`p-${String(t)}`,r[t],n(null),n)},T=(t,e=t)=>({host:s,target:r})=>$(s,e,r,`a-${t}`,r.getAttribute(t),(e=>()=>e.removeAttribute(t)),(e=>s=>()=>s.setAttribute(t,e))),j=(t,e=t)=>({host:s,target:r})=>{const n=e=>s=>()=>s.toggleAttribute(t,e);return $(s,e,r,`a-${t}`,r.hasAttribute(t),n(!1),n)},D=(t,e=t)=>({host:s,target:r})=>$(s,e,r,`c-${t}`,r.classList.contains(t),(e=>()=>e.classList.remove(t)),(e=>s=>()=>s.classList.toggle(t,e))),J=(t,e=t)=>({host:s,target:r})=>$(s,e,r,`s-${t}`,r.style[t],(e=>()=>e.style.removeProperty(t)),(e=>s=>()=>s.style[t]=e)),P=t=>s(t)?P(t()):t;class H extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)||this.registry.define(t,this)}catch(e){g(t,e.message,h)}}#t=new Map;self=[u(this,this)];attributeChangedCallback(t,e,r){if(r===e)return;const n=this.constructor.attributeMap[t];this.set(t,s(n)?n(i(r),this,e)[0]:r)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new x(t,(e=>this.set(String(t),e))))}));const r=t.providedContexts||[];r.length&&this.addEventListener(w,(t=>{const{context:e,callback:n}=t;r.includes(e)&&s(n)&&(t.stopPropagation(),n(this.#t.get(String(e))))}))}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return P(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);b(s)&&s.set(e)}}else this.#t.set(t,m(e)?e:y(e))}delete(t){return this.#t.delete(t)}signal(t){return this.#t.get(t)}first=(t=>e=>i(l(t).querySelector(e)).map((e=>u(t,e))))(this);all=(t=>e=>Array.from(l(t).querySelectorAll(e)).map((e=>u(t,e))))(this)}export{H as UIElement,M as asBoolean,S as asInteger,L as asJSON,k as asNumber,q as asString,A as dispatch,v as effect,g as log,i as maybe,N as off,C as on,E as pass,T as setAttribute,O as setProperty,J as setStyle,F as setText,j as toggleAttribute,D as toggleClass};
