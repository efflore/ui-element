const t=t=>e=>typeof e===t,e=t("symbol"),s=t("number"),r=t("string"),n=t("object"),a=t=>r(t)||e(t)||s(t),i=t("function"),o=(t,...e)=>i(t)?t(...e):void 0,l=t=>null===t,c=t=>null==t,u=t=>null!=t,d=t=>u(t)&&(n(t)||i(t)),g=(t,e)=>d(t)&&Symbol.toStringTag in t&&t[Symbol.toStringTag]===e,b=t=>t.nodeType===Node.COMMENT_NODE,p="debug",h="info",m="warn",f="error",S=(t,e,s=p)=>([f,m].includes(s)&&console[s](e,t),t),v="Ok",x="None",y="Fail",$=t=>({[Symbol.toStringTag]:v,value:t,map:e=>$(e(t)),flatMap:e=>e(t),filter:e=>e(t)?$(t):w(),guard:e=>e(t)?$(t):w(),or:()=>$(t),get:()=>t}),w=()=>{const t=()=>w();return{[Symbol.toStringTag]:x,map:t,flatMap:t,filter:t,guard:t,or:t=>N(t),get:()=>{}}},M=t=>{const e=()=>M(t);return{[Symbol.toStringTag]:y,error:t,map:e,flatMap:e,filter:e,guard:e,or:t=>N(t),get:()=>{throw t}}},A=t=>g(t,v),C=t=>g(t,x),E=t=>g(t,y),k=t=>A(t)||C(t)||E(t),N=t=>u(t)?$(t):w(),O=t=>{try{return N(t())}catch(t){return M(t)}},T=(t,e=0,s=1e3)=>{const r=async(e,s)=>{const n=O((async()=>await t()));return await L({[y]:async t=>e<1?M(t):(await new Promise((t=>setTimeout(t,s))),r(e-1,2*s))})(n)};return r(e,s)},q=(...t)=>t.reduce(((t,e)=>o(e,t))),L=t=>e=>{const s=t[e[Symbol.toStringTag]]||t.else,r=(t,e)=>t&&e in t&&t[e]||void 0,n=N(r(e,"value")).or(r(e,"error")).get();return N(s).guard(i).map((t=>t(n))).or(n).get()},j="State",P="Computed";let R;const{enqueue:F,cleanup:I}=(()=>{const t=new Map,e=new Map;let s;const r=(t,e)=>{const s=O(t);L({[y]:t=>S(t,e,f)})(s)},n=()=>{s=null,t.forEach(((t,e)=>t.forEach(((t,s)=>r(t(e),`Effect ${s} on ${e?.localName||"unknown"} failed`))))),t.clear(),e.forEach((t=>r(t,"Cleanup failed"))),e.clear()},a=t=>(e,r)=>{const a=!t.has(e);t.set(e,r),a&&(s&&cancelAnimationFrame(s),s=requestAnimationFrame(n))};return queueMicrotask(n),{enqueue:(e,s,r)=>{return a((n=e,t.has(n)||t.set(n,new Map),t.get(n)))(s,r);var n},cleanup:a(e)}})(),D=t=>{R&&t.add(R)},V=t=>t.forEach((t=>t())),U=(t,e)=>{const s=R;R=e;const r=O(t);L({[y]:t=>S(t,"Error during reactive computation",f)})(r),R=s},J=t=>g(t,j),z=t=>g(t,P),H=t=>J(t)||z(t),G=t=>{const e=new Set;return{[Symbol.toStringTag]:j,get:()=>(D(e),t),set(s){const r=t;t=i(s)&&s.length?s(t):s,Object.is(t,r)||V(e)},get targets(){return[...e]}}},K=(t,e=!1)=>{const s=new Set;let r,n=!0;const a=()=>{n=!0,e&&V(s)};return{[Symbol.toStringTag]:P,get:()=>(D(s),e&&!n||U((()=>{r=t(),n=c(r)}),a),r),get targets(){return[...s]}}},_=t=>{const e=()=>U((()=>N(t(F)).guard(i).map((e=>I(t,e)))),e);e()},B="UI",Q=(t,e=t)=>({[Symbol.toStringTag]:"UI",host:t,target:e}),W=t=>$(Q(t)),X=t=>e=>N(t.root.querySelector(e)).map((e=>Q(t,e))),Y=t=>e=>Array.from(t.root.querySelectorAll(e)).map((e=>Q(t,e))),Z=t=>i(t)&&!!t.length,tt=(t,e,s,r=void 0)=>N(t.constructor.attributeMap[e]).guard(Z).map((e=>e(N(s),t,r))).or(s).get(),et="context-request";class st extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(et,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const rt="debug",nt=t=>{return`<${t.localName}${s=t.id,s?`#${s}`:""}${e=t.classList,e.length?`.${Array.from(e).join(".")}`:""}>`;var e,s},at=t=>r(t)?`"${t}"`:n(t)?JSON.stringify(t):u(t)?t.toString():"undefined";class it extends HTMLElement{static registry=customElements;static attributeMap={};static observedAttributes;static consumedContexts;static providedContexts;static define(t){const e=O((()=>it.registry.define(t,this)));L({[y]:e=>S(t,e.message,f),[v]:()=>S(t,"Registered custom element")})(e)}signals=new Map;internals;self=W(this);root=this.shadowRoot||this;attributeChangedCallback(t,e,s){s!==e&&(S(`${at(e)} => ${at(s)}`,`Attribute "${t}" of ${nt(this)} changed`),this.set(t,tt(this,t,s,e)))}connectedCallback(){r(this.getAttribute(rt))&&this.set(rt,!0),(t=>{const e=t.constructor,s=e.consumedContexts||[];setTimeout((()=>{for(const e of s)t.dispatchEvent(new st(e,(s=>t.set(String(e),s))))}));const r=e.providedContexts||[];r.length&&t.addEventListener(et,(e=>{const{context:s,callback:n}=e;r.includes(s)&&i(n)&&(e.stopPropagation(),n(t.signals.get(String(s))))}))})(this),S(nt(this),"Connected")}disconnectedCallback(){S(nt(this),"Disconnected")}adoptedCallback(){S(nt(this),"Adopted")}has(t){return this.signals.has(t)}get(t){const e=t=>d(t)?i(t)?e(t()):H(t)||k(t)?e(t.get()):t:t;return S(e(this.signals.get(t)),`Get current value of state ${at(t)} in ${nt(this)}`)}set(t,e,s=!0){if(E(e))return void S(e.error,`Unhandled error before trying to set state '${t}' in <${this.localName}>`,f);const r=k(e)?e.get():e;if(S(r,`Set ${s?"":"default "}value of state ${at(t)} in ${nt(this)} to`),this.signals.has(t)){if(s){const e=this.signals.get(t);H(r)?(S(r.get(),`Existing state ${at(t)} in ${nt(this)} is replaced by new signal`),this.signals.set(t,r),e.targets.forEach((t=>t()))):J(e)?e.set(r):S(r,`Computed state ${at(t)} in ${nt(this)} cannot be set`,f)}}else this.signals.set(t,H(r)?r:G(r))}delete(t){return S(this.signals.delete(t),`Delete state ${at(t)} from ${nt(this)}`)}first=X(this);all=Y(this)}const ot=t=>async e=>{await e.host.constructor.registry.whenDefined(e.target.localName);for(const[s,r=s]of Object.entries(t)){const t=a(r)?e.host.signals.get(r):H(r)?r:i(r)?G(r):e.host.signals.get(r);e.target.set(s,t)}return e},lt=(t,e)=>s=>(s.target.addEventListener(t,e),s),ct=(t,e)=>s=>(s.target.removeEventListener(t,e),s),ut=(t,e=t)=>s=>(_((()=>{s.target.dispatchEvent(new CustomEvent(t,{detail:s.host.get(e),bubbles:!0}))})),s),dt=t=>N(u(t.get())),gt=t=>t.map((t=>parseInt(t,10))).filter(Number.isFinite),bt=t=>t.map(parseFloat).filter(Number.isFinite),pt=t=>t,ht=t=>{const e=O((()=>t.map((t=>JSON.parse(t)))));return L({[y]:t=>(S(t,"Failed to parse JSON",f),w())})(e)},mt=(t,e,s,n,a,o)=>{const u=n();if(!i(e)){const s=r(e)&&r(u)?tt(t.host,e,u):u;t.host.set(e,s,!1)}return _((r=>{const d=n(),g=i(e)?e(d):t.host.get(e);if(!Object.is(g,d)){const e=o&&l(g)?o:c(g)?a(u):a(g);r(t.target,s,e)}})),t},ft=t=>e=>mt(e,t,"t",(()=>e.target.textContent||""),(t=>e=>()=>{Array.from(e.childNodes).filter((t=>!b(t))).forEach((t=>t.remove())),e.append(document.createTextNode(t))})),St=(t,e=t)=>s=>mt(s,e,`p-${String(t)}`,(()=>s.target[t]),(e=>s=>()=>s[t]=e)),vt=(t,e=t)=>s=>mt(s,e,`a-${t}`,(()=>s.target.getAttribute(t)),(e=>s=>()=>s.setAttribute(t,e)),(e=>()=>e.removeAttribute(t))),xt=(t,e=t)=>s=>mt(s,e,`a-${t}`,(()=>s.target.hasAttribute(t)),(e=>s=>()=>s.toggleAttribute(t,e))),yt=(t,e=t)=>s=>mt(s,e,`c-${t}`,(()=>s.target.classList.contains(t)),(e=>s=>()=>s.classList.toggle(t,e))),$t=(t,e=t)=>s=>mt(s,e,`s-${t}`,(()=>s.target.style.getPropertyValue(t)),(e=>s=>()=>s.style.setProperty(t,e)),(e=>()=>e.style.removeProperty(t))),wt=(t,e,s)=>{t.internals&&(t.set(e,t.hasAttribute(e),!1),_((r=>{const n=t.internals.states.has(e),a=t.get(e);Object.is(a,n)||r(t,`i-${e}`,a?t=>()=>{t.internals.states.add(e),s&&(t.internals[s]="true",t.setAttribute(`aria-${e}`,"true")),t.toggleAttribute(e,!0)}:t=>()=>{t.internals.states.delete(e),s&&(t.internals[s]="false",t.setAttribute(`aria-${e}`,"false")),t.toggleAttribute(e,!1)})})))},Mt=(t,e,s)=>{t.internals&&(t.set(e,tt(t,e,t.getAttribute(e)),!1),_((r=>{const n=t.internals[s],a=String(t.get(e));a!==n&&r(t,`i-${e}`,u(a)?t=>()=>{t.internals[s]=a,t.setAttribute(`aria-${e}`,a)}:t=>()=>{t.internals[s]=void 0,t.removeAttribute(`aria-${e}`)})})))},At=t=>{t.internals||(t.internals=t.attachInternals());const e=t.constructor,s=(t,e)=>e.forEach((e=>{return t.set(e,(s=e).charAt(0).toUpperCase()+s.slice(1));var s})),r=t.role,n=new Map([]);s(n,["disabled","hidden"]);const a=new Map,i=new Map([["keyshortcuts","KeyShortcuts"]]);if(s(i,["controls","description","label"]),s(e.attributeMap.current===dt?n:i,["current"]),r&&i.set("roledescription","RoleDescription"),t.hasAttribute("aria-live")&&(s(n,["atomic","busy"]),s(i,["live","relevant"])),["textbox","combobox"].includes(r)&&i.set("autocomplete","AutoComplete"),["checkbox","menuitemcheckbox","menuitemradio","radio","switch"].includes(r)&&s(e.attributeMap.checked===dt?n:i,["checked"]),["table","grid","treegrid"].includes(r)&&(a.set("colcount","ColCount"),a.set("colindex","ColIndex"),a.set("colspan","ColSpan"),a.set("rowcount","RowCount"),a.set("rowindex","RowIndex"),a.set("rowspan","RowSpan")),["button","link","treeitem","grid","row","listbox","tabpanel","menuitem","combobox"].includes(r)&&s(n,["expanded"]),["button","link","menuitem","combobox","gridcell"].includes(r)&&(e.attributeMap.haspopup===dt?n:i).set("haspopup","HasPopup"),["heading","treeitem","listitem"].includes(r)&&a.set("level","Level"),"dialog"===r&&n.set("modal","Modal"),"textbox"===r&&(n.set("multiline","MultiLine"),i.set("placeholder","Placeholder")),["listbox","grid","table","tree"].includes(r)&&n.set("multiselectable","MultiSelectable"),["scrollbar","slider","separator","progressbar","tabpanel"].includes(r)&&i.set("orientation","Orientation"),["listitem","treeitem"].includes(r)&&a.set("posinset","PosInSet"),["button","switch"].includes(r)&&s(e.attributeMap.pressed===dt?n:i,["pressed"]),["textbox","gridcell","spinbutton"].includes(r)&&n.set("readonly","ReadOnly"),["textbox","gridcell","spinbutton","combobox","listbox"].includes(r)&&n.set("required","Required"),["gridcell","listitem","option","tab","treeitem"].includes(r)&&n.set("selected","Selected"),["listitem","treeitem","option","row","tab"].includes(r)&&a.set("setsize","SetSize"),["grid","treegrid","table"].includes(r)&&i.set("sorted","Sorted"),["range","progressbar","slider","spinbutton"].includes(r)&&(a.set("valuemax","ValueMax"),a.set("valuemin","ValueMin"),a.set("valuenow","ValueNow"),i.set("valuetext","ValueText")),e.observedAttributes)for(const s of e.observedAttributes)a.has(s)?(Object.hasOwn(e.attributeMap,s)||(e.attributeMap[s]="value"===s.slice(0,5)?bt:gt),Mt(t,s,`aria${a.get(s)}`)):i.has(s)?Mt(t,s,`aria${i.get(s)}`):n.has(s)&&(Object.hasOwn(e.attributeMap,s)||(e.attributeMap[s]=dt),wt(t,s,`aria${n.get(s)}`))};export{p as LOG_DEBUG,f as LOG_ERROR,h as LOG_INFO,m as LOG_WARN,P as TYPE_COMPUTED,y as TYPE_FAIL,x as TYPE_NONE,v as TYPE_OK,j as TYPE_STATE,B as TYPE_UI,it as UIElement,Y as all,dt as asBoolean,gt as asInteger,ht as asJSON,bt as asNumber,pt as asString,o as callFunction,K as computed,_ as effect,ut as emit,M as fail,X as first,q as flow,b as isComment,z as isComputed,u as isDefined,d as isDefinedObject,E as isFail,i as isFunction,C as isNone,l as isNull,c as isNullish,s as isNumber,n as isObject,g as isObjectOfType,A as isOk,a as isPropertyKey,k as isResult,H as isSignal,J as isState,r as isString,e as isSymbol,S as log,L as match,N as maybe,w as none,ct as off,$ as ok,lt as on,tt as parse,ot as pass,O as result,W as self,vt as setAttribute,Mt as setInternal,St as setProperty,$t as setStyle,ft as setText,G as state,At as syncInternals,T as task,xt as toggleAttribute,yt as toggleClass,wt as toggleInternal,Q as ui};
