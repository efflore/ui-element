const t=t=>"function"==typeof t,e=(e,s=[],a=e)=>t(e)?e.call(...s):a;let s;const a=new WeakMap,r=t=>{const e={get:()=>{const a=s;s=e;const r=t();return s=a,r}};return e};export default class extends HTMLElement{static define(t,e=customElements){try{e.get(t)||e.define(t,this)}catch(t){console.error(t)}}attributeMap;#t=new Map;attributeChangedCallback(s,a,r){if(r!==a){const n=this.attributeMap?.get(s),[i,o]=Array.isArray(n)?n:[s,n],c={boolean:t=>"string"==typeof t,integer:t=>parseInt(t,10),number:t=>parseFloat(t)};this.set(i,e(t(o)?o:c[o],[this,r,a],r))}}has(t){return this.#t.has(t)}get(t){return this.#t.get(t)?.get()}set(n,i,o=!0){const c=this.#t.get(n);return this.#t.has(n)?o&&e(c.set,[c,i]):(()=>{this.#t.set(n,t(i)?r(i):(t=>{const r=t=>(!a.has(t)&&a.set(t,new Set),a.get(t)),n={get:()=>(s&&r(n).add(s),t),set:s=>{const a=t;t=e(s,[n,a],s),!Object.is(t,a)&&r(n).forEach((t=>t.get()))}};return n})(i)),!Object.prototype.hasOwnProperty.call(this,n)&&Object.defineProperty(this,n,{get:()=>this.#t.get(n)?.get(),set:t=>{const s=this.#t.get(n);e(s.set,[s,t])},configurable:!0,enumerable:!0})})(),c?.get()}delete(t){return delete this[t],this.#t.delete(t)}effect(t){requestAnimationFrame((()=>r(t).get()))}}