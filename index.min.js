const t=t=>e=>typeof e===t,e=t("object"),s=t("function"),r=t=>null==t,n=t=>null!=t,a=t=>t.nodeType!==Node.COMMENT_NODE,o=t=>r(t)?[]:[t],c="warn",i="error",l=(t,e,s="debug")=>([i,c].includes(s)&&console[s](e,t),t),{enqueue:u,cleanup:h}=(()=>{const t=new Map,e=new Map;let s;const r=(t,e)=>{try{t()}catch(t){l(t,e,i)}},n=()=>{s=null,t.forEach(((t,e)=>t.forEach(((t,s)=>r(t(e),`Effect ${s} on ${e?.localName||"unknown"} failed`))))),t.clear(),e.forEach((t=>r(t,"Cleanup failed"))),e.clear()},a=t=>(e,r)=>{const a=!t.has(e);t.set(e,r),a&&(s&&cancelAnimationFrame(s),s=requestAnimationFrame(n))};return queueMicrotask(n),{enqueue:(e,s,r)=>{return a((n=e,t.has(n)||t.set(n,new Map),t.get(n)))(s,r);var n},cleanup:a(e)}})();let g;const d=t=>(t=>n(t)&&(e(t)||s(t)))(t)&&s(t["set"]),p=t=>{const e=new Set,r=()=>((t=>{g&&t.add(g)})(e),t);return r.set=r=>{const n=t;t=s(r)&&!d(r)?r(t):r,Object.is(t,n)||(t=>{t.forEach((t=>t()))})(e)},r},f=t=>{const e=()=>((t,e)=>{const s=g;g=e;try{t()}catch(t){l(t,"Error during reactive computation",i)}finally{g=s}})((()=>{const e=t(u);s(e)&&h(t,e)}),e);e()},m="context-request";class b extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(m,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const y=t=>async e=>{await e.host.constructor.registry.whenDefined(e.target.localName);for(const[r,n]of Object.entries(t))e.target.set(r,d(n)?n:s(n)?p(n):e.host.signal(n));return e},E=(t,e)=>s=>(s.target.addEventListener(t,e),s),v=(t,e)=>s=>(s.target.removeEventListener(t,e),s),x=(t,e=t)=>s=>(f((()=>{s.target.dispatchEvent(new CustomEvent(t,{detail:s.host.get(e),bubbles:!0}))})),s),w=t=>[n(t[0])],C=t=>t.map((t=>parseInt(t,10))).filter(Number.isFinite),N=t=>t.map(parseFloat).filter(Number.isFinite),A=t=>t,M=t=>{let e=[];try{e=t.map((t=>JSON.parse(t)))}catch(t){l(t,"Failed to parse JSON",i)}return e},S=(t,e,n,a,o,c)=>(t.host.set(e,s(e)?e:a,!1),f((s=>{if(t.host.has(e)){const a=t.host.get(e);s(t.target,n,r(a)?o:c(a))}})),t),k=t=>e=>{const s=e.target.textContent||"",r=t=>e=>()=>{Array.from(e.childNodes).filter(a).forEach((t=>t.remove())),e.append(document.createTextNode(t))};return S(e,t,"t",s,r(s),r)},q=(t,e=t)=>s=>{const r=e=>s=>()=>s[t]=e;return S(s,e,`p-${String(t)}`,s.target[t],r(null),r)},L=(t,e=t)=>s=>S(s,e,`a-${t}`,s.target.getAttribute(t),(e=>()=>e.removeAttribute(t)),(e=>s=>()=>s.setAttribute(t,e))),$=(t,e=t)=>s=>{const r=e=>s=>()=>s.toggleAttribute(t,e);return S(s,e,`a-${t}`,s.target.hasAttribute(t),r(!1),r)},F=(t,e=t)=>s=>S(s,e,`c-${t}`,s.target.classList.contains(t),(e=>()=>e.classList.remove(t)),(e=>s=>()=>s.classList.toggle(t,e))),O=(t,e=t)=>s=>S(s,e,`s-${t}`,s.target.style[t],(e=>()=>e.style.removeProperty(t)),(e=>s=>()=>s.style[t]=e)),T=t=>s(t)?T(t()):t;class j extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)||this.registry.define(t,this)}catch(e){l(t,e.message,i)}}#t=new Map;self=[{host:this,target:this}];root=this.shadowRoot||this;attributeChangedCallback(t,e,r){if(r===e)return;const n=this.constructor.attributeMap[t];this.set(t,s(n)?n(o(r),this,e)[0]:r)}connectedCallback(){(t=>{const e=t.constructor,r=e.consumedContexts||[];for(const e of r)t.set(String(e),void 0,!1);setTimeout((()=>{for(const e of r)t.dispatchEvent(new b(e,(s=>t.set(String(e),s))))}));const n=e.providedContexts||[];n.length&&t.addEventListener(m,(e=>{const{context:r,callback:a}=e;n.includes(r)&&s(a)&&(e.stopPropagation(),a(t.get(String(r))))}))})(this)}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return T(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);d(s)&&s.set(e)}}else this.#t.set(t,d(e)?e:p(e))}delete(t){return this.#t.delete(t)}signal(t){return this.#t.get(t)}first(t){return o(this.root.querySelector(t)).map((t=>({host:this,target:t})))}all(t){return Array.from(this.root.querySelectorAll(t)).map((t=>({host:this,target:t})))}}export{j as UIElement,w as asBoolean,C as asInteger,M as asJSON,N as asNumber,A as asString,f as effect,x as emit,l as log,o as maybe,v as off,E as on,y as pass,L as setAttribute,q as setProperty,O as setStyle,k as setText,$ as toggleAttribute,F as toggleClass};
