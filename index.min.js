const t=t=>"function"==typeof t;let e;const s=t=>{const s={get:()=>{const a=e;e=s;const n=t();return e=a,n}};return s};export default class extends HTMLElement{static define(t,e=customElements){try{e.get(t)||e.define(t,this)}catch(t){console.error(t)}}attributeMap;#t=new Map;attributeChangedCallback(e,s,a){if(a!==s){const n=this.attributeMap?.get(e),[r,o]=Array.isArray(n)?n:[e,n],i={boolean:t=>"string"==typeof t,integer:t=>parseInt(t,10),number:t=>parseFloat(t)},c=t(o)?o:i[o];this.set(r,c?c(a,s):a)}}has(t){return this.#t.has(t)}get(t){return this.#t.get(t)?.get()}set(a,n,r=!0){if(this.#t.has(a)){const e=this.#t.get(a);r&&t(e.set)&&e.set(n)}else{const r="object"==typeof n&&t(n.get)?n:t(n)?s(n):(s=>{const a=new WeakMap,n=t=>(!a.has(t)&&a.set(t,new Set),a.get(t)),r={get:()=>(e&&n(r).add(e),s),set:e=>{const a=s;if(s=t(e)?e(a):e,!Object.is(s,a))for(const t of n(r))t.get()}};return r})(n);this.#t.set(a,r)}}delete(t){return this.#t.delete(t)}pass(e,s,a=customElements){(async()=>{await a.whenDefined(e.localName);for(const[a,n]of s)e.set(a,t(n)?{get:n}:this.#t.get(n))})()}effect(t){requestAnimationFrame((()=>s(t).get()))}}