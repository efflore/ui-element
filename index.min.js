const t=t=>e=>typeof e===t,e=t("string"),s=t("object"),r=t("function"),n=t=>null==t,a=t=>null!=t,o=t=>t.nodeType!==Node.COMMENT_NODE,c=t=>n(t)?[]:[t],i="warn",l="error",u=(t,e,s="debug")=>([l,i].includes(s)&&console[s](e,t),t),{enqueue:h,cleanup:g}=(()=>{const t=new Map,e=new Map;let s;const r=(t,e)=>{try{t()}catch(t){u(t,e,l)}},n=()=>{s=null,t.forEach(((t,e)=>t.forEach(((t,s)=>r(t(e),`Effect ${s} on ${e?.localName||"unknown"} failed`))))),t.clear(),e.forEach((t=>r(t,"Cleanup failed"))),e.clear()},a=t=>(e,r)=>{const a=!t.has(e);t.set(e,r),a&&(s&&cancelAnimationFrame(s),s=requestAnimationFrame(n))};return queueMicrotask(n),{enqueue:(e,s,r)=>{return a((n=e,t.has(n)||t.set(n,new Map),t.get(n)))(s,r);var n},cleanup:a(e)}})();let d;const p=t=>(t=>a(t)&&(s(t)||r(t)))(t)&&r(t["set"]),f=t=>{const e=new Set,s=()=>((t=>{d&&t.add(d)})(e),t);return s.set=s=>{const n=t;t=r(s)&&!p(s)?s(t):s,Object.is(t,n)||(t=>{t.forEach((t=>t()))})(e)},s},m=t=>{const e=()=>((t,e)=>{const s=d;d=e;try{t()}catch(t){u(t,"Error during reactive computation",l)}finally{d=s}})((()=>{const e=t(h);r(e)&&g(t,e)}),e);e()},b=(t,e,s,n)=>{const a=t.constructor.attributeMap[e];return r(a)?a(c(s),t,n)[0]:s},y="context-request";class v extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(y,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const E=t=>async e=>{await e.host.constructor.registry.whenDefined(e.target.localName);for(const[s,n]of Object.entries(t))e.target.set(s,p(n)?n:r(n)?f(n):e.host.signal(n));return e},x=(t,e)=>s=>(s.target.addEventListener(t,e),s),w=(t,e)=>s=>(s.target.removeEventListener(t,e),s),C=(t,e=t)=>s=>(m((()=>{s.target.dispatchEvent(new CustomEvent(t,{detail:s.host.get(e),bubbles:!0}))})),s),N=t=>[a(t[0])],A=t=>t.map((t=>parseInt(t,10))).filter(Number.isFinite),M=t=>t.map(parseFloat).filter(Number.isFinite),S=t=>t,k=t=>{let e=[];try{e=t.map((t=>JSON.parse(t)))}catch(t){u(t,"Failed to parse JSON",l)}return e},q=(t,s,a,o,c,i)=>(t.host.set(s,r(s)?s:e(s)&&e(o)?b(t.host,s,o,void 0):o,!1),m((e=>{if(t.host.has(s)){const r=t.host.get(s);e(t.target,a,n(r)?c:i(r))}})),t),L=t=>e=>{const s=e.target.textContent||"",r=t=>e=>()=>{Array.from(e.childNodes).filter(o).forEach((t=>t.remove())),e.append(document.createTextNode(t))};return q(e,t,"t",s,r(s),r)},$=(t,e=t)=>s=>{const r=e=>s=>()=>s[t]=e;return q(s,e,`p-${String(t)}`,s.target[t],r(null),r)},F=(t,e=t)=>s=>q(s,e,`a-${t}`,s.target.getAttribute(t),(e=>()=>e.removeAttribute(t)),(e=>s=>()=>s.setAttribute(t,e))),O=(t,e=t)=>s=>{const r=e=>s=>()=>s.toggleAttribute(t,e);return q(s,e,`a-${t}`,s.target.hasAttribute(t),r(!1),r)},T=(t,e=t)=>s=>q(s,e,`c-${t}`,s.target.classList.contains(t),(e=>()=>e.classList.remove(t)),(e=>s=>()=>s.classList.toggle(t,e))),j=(t,e=t)=>s=>q(s,e,`s-${t}`,s.target.style[t],(e=>()=>e.style.removeProperty(t)),(e=>s=>()=>s.style[t]=e)),D=t=>r(t)?D(t()):t;class J extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)||this.registry.define(t,this)}catch(e){u(t,e.message,l)}}#t=new Map;self=[{host:this,target:this}];root=this.shadowRoot||this;attributeChangedCallback(t,e,s){s!==e&&this.set(t,b(this,t,s,e))}connectedCallback(){(t=>{const e=t.constructor,s=e.consumedContexts||[];for(const e of s)t.set(String(e),void 0,!1);setTimeout((()=>{for(const e of s)t.dispatchEvent(new v(e,(s=>t.set(String(e),s))))}));const n=e.providedContexts||[];n.length&&t.addEventListener(y,(e=>{const{context:s,callback:a}=e;n.includes(s)&&r(a)&&(e.stopPropagation(),a(t.get(String(s))))}))})(this)}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return D(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);p(s)&&s.set(e)}}else this.#t.set(t,p(e)?e:f(e))}delete(t){return this.#t.delete(t)}signal(t){return this.#t.get(t)}first(t){return c(this.root.querySelector(t)).map((t=>({host:this,target:t})))}all(t){return Array.from(this.root.querySelectorAll(t)).map((t=>({host:this,target:t})))}}export{J as UIElement,N as asBoolean,A as asInteger,k as asJSON,M as asNumber,S as asString,m as effect,C as emit,u as log,c as maybe,w as off,x as on,E as pass,F as setAttribute,$ as setProperty,j as setStyle,L as setText,O as toggleAttribute,T as toggleClass};
