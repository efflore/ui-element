/**
 * @license
 * Copyright 2024 Esther Brunner
 * SPDX-License-Identifier: BSD-3-Clause
 */
let t=null;const e=new WeakMap,s=t=>"function"==typeof t,a=t=>(!e.has(t)&&e.set(t,new Set),e.get(t));export default class extends HTMLElement{attributeMapping={};#t=new Map;attributeChangedCallback(t,e,a){if(a!==e){const n=this.attributeMapping[t],[i,r]=Array.isArray(n)?n:[t,n],h=s(r)?r.call(this,a,e):((t,e)=>{const s={boolean:t=>"string"==typeof t,integer:t=>parseInt(t,10),number:t=>parseFloat(t)};return s[e]?s[e](t):t})(a,r);this.set(i,h)}}has(t){return this.#t.has(t)}get(t,e=!1){if(!this.#t.has(t))return;const s=this.#t.get(t);return e?s:s()}set(e,n){this.#t.has(e)?this.#t.get(e).set(n):s(n)&&s(n.set)?this.#t.set(e,n):this.#t.set(e,(e=>{const n=()=>(t&&a(n).add(t),s(e)?e():e);return n.set=t=>{const i=e;(e=s(t)?t(i):t)!==i&&a(n).forEach((t=>t()))},n})(n))}delete(t){this.#t.has(t)&&(this.#t.get(t).set(),this.#t.delete(t))}effect(e){(e=>{const a=()=>{t=a;const n=e();s(n)&&setTimeout(n),t=null};requestAnimationFrame(a)})(e)}}