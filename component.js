const t=t=>e=>typeof e===t,e=t("symbol"),s=t("object"),n=t("function"),o=t=>null!=t,r=t=>o(t)&&(s(t)||n(t)),c=t=>t.nodeType!==Node.COMMENT_NODE,a=Symbol(),i=t=>n(t)?i(t()):t,l=(t,e)=>t&&n(t[e]),d=t=>(t=>null==t)(t)||((t,s=[])=>n(t)&&"type"in t&&(!s.length||e(t.type)&&s.includes(t.type)))(t,[a]),u=t=>d(t)?h():p(t),p=t=>{const e=()=>t;return e.type=Symbol(typeof t),e.toString=()=>String(t),e.map=e=>u(e(t)),e.or=()=>p(t),e},h=()=>new Proxy((()=>{}),{get:(t,e)=>"type"===e?a:"toString"===e?()=>"":"or"===e?t=>u(t()):()=>h()}),b=Symbol(),f=Symbol();let m;const y=t=>n(t)&&l(t,"set"),g=t=>y(t)||(t=>n(t)&&l(t,"run")&&"effects"in t)(t),x=t=>{const e=()=>(m&&e.effects.add(m),t);return e.type=b,e.effects=new Set,e.set=s=>{const o=t;t=n(s)&&!g(s)?(t=>r(t)&&l(t,"map"))(t)?t.map(s):s(t):s,Object.is(i(t),i(o))||(t=>{for(const e of t)e.run()})(e.effects)},e},C=t=>{const e=new Map,s=()=>{const o=m;m=s;const r=t(((t,s)=>{e.has(t)||e.set(t,new Set),e.get(t)?.add(s)}));for(const t of e.values()){for(const e of t)e();t.clear()}m=o,n(r)&&queueMicrotask(r)};s.type=f,s.run=()=>s(),s.targets=e,s()},v="context-request";class S extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(v,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}class E extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){try{this.registry.get(t)&&this.registry.define(t,this)}catch(t){console.error(t)}}#t=new Map;attributeChangedCallback(t,e,s){if(s===e)return;const o=this.constructor.attributeMap[t],r=u(s);this.set(t,n(o)?o(r,this,e):r)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new S(t,(e=>this.set(String(t),e))))}));const s=t.providedContexts||[];s.length&&this.addEventListener(v,(t=>{const{context:e,callback:o}=t;s.includes(e)&&n(o)&&(t.stopPropagation(),o(this.#t.get(String(e))))}))}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return i(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);y(s)&&s.set(e)}}else this.#t.set(t,g(e)?e:x(e))}delete(t){return this.#t.delete(t)}async pass(t,e){if(await this.constructor.registry.whenDefined(t.localName),!l(t,"set"))throw new TypeError("Expected UIElement");for(const[s,o]of Object.entries(e))t.set(s,g(o)?o:n(o)?x(o):this.#t.get(o))}signal(t){return this.#t.get(t)}}const M=t=>Number.isFinite(t)?t:void 0,k=t=>t.map((()=>!0)).or((()=>!1)),w=t=>t.map((t=>M(parseInt(t,10)))),A=t=>t.map((t=>M(parseFloat(t)))),L=t=>t,N=t=>t.map((t=>{let e;try{e=JSON.parse(t)}catch(t){console.error(t)}return e})),T=(t,e)=>{const s=()=>t;s.map=s=>T(s(t,e),e),s.on=(e,s)=>(t.addEventListener(e,s),()=>t.removeEventListener(e,s));const n=(n,o,r)=>(e.set(n,o,!1),C((s=>e.has(n)&&s(t,(()=>r(e.get(n),o))))),s);if(s.text=e=>n(e,t.textContent||"",((e,s)=>{Array.from(t.childNodes).filter(c).forEach((t=>t.remove())),t.append(document.createTextNode(o(e)?e:s))})),s.prop=(e,s=e)=>n(s,t[e],(s=>t[e]=s)),s.attr=(e,s=e)=>n(s,t.getAttribute(e),(s=>o(s)?t.setAttribute(e,String(s)):t.removeAttribute(e))),s.bool=(e,s=e)=>n(s,t.hasAttribute(e),(s=>t.toggleAttribute(e,s))),s.class=(e,s=e)=>n(s,t.classList.contains(e),(s=>t.classList[s?"add":"remove"](e))),(t=>{for(const e of[HTMLElement,SVGElement,MathMLElement])if(t instanceof e)return!0;return!1})(t)&&(s.style=(e,s=e)=>n(s,t.style[e],(s=>o(s)?t.style[e]=String(s):t.style.removeProperty(e)))),e===t){const t=e.shadowRoot||e;s.first=s=>{const n=t.querySelector(s);return n?T(n,e):h()},s.all=s=>Array.from(t.querySelectorAll(s)).map((t=>T(t,e)))}return s},O=(t,e={},s,o=E)=>{const c=class extends o{static observedAttributes=r(e.attributeMap)?Object.keys(e.attributeMap):[];static attributeMap=e.attributeMap||{};static providedContexts=e.providedContexts||[];static consumedContexts=e.consumedContexts||[];disconnect;connectedCallback(){if(super.connectedCallback(),!n(s))return;const t=s(this,T(this,this));n(t)&&(this.disconnect=t)}disconnectedCallback(){"disconnectedCallback"in o&&super.disconnectedCallback(),this.disconnect()}};return c.define(t),c};export{k as asBoolean,w as asInteger,N as asJSON,A as asNumber,L as asString,O as component,E as default,C as effect,u as maybe,T as ui};
