const t=t=>e=>typeof e===t,e=t("object"),s=t("function"),n=t=>(t=>null!=t)(t)&&(e(t)||s(t)),o=(t,e)=>s(t[e]),c=t=>t.nodeType!==Node.COMMENT_NODE,r=()=>({map:()=>r(),fold:t=>t()}),a=t=>({map:e=>a(e(t)),fold:(e,s)=>s(t)}),i=t=>(t=>null==t)(t)?r():a(t),l=(t,e)=>({get:()=>e,map:s=>(s(t,e),l(t,e))}),d=t=>({run:()=>t()});let u;const f=t=>n(t)&&o(t,"set"),h=t=>f(t)||(t=>n(t)&&o(t,"run")&&"effects"in t)(t),p=t=>{const e=()=>(u&&e.effects.add(u),t);return e.effects=new Set,e.set=n=>{const o=t;t=s(n)&&!h(n)?n(t):n,Object.is(t,o)||(t=>{for(const e of t)e.run()})(e.effects)},e},b=t=>{const e=new Map,n=()=>{const o=u;u=n;const c=t(((t,s)=>{e.has(t)||e.set(t,new Set),e.get(t)?.add(s)}));for(const t of e.values()){for(const e of t)e.run();t.clear()}u=o,s(c)&&queueMicrotask(c)};n.run=()=>n(),n.targets=e,n()},m=t=>({map:()=>m(t),fold:e=>e(t),catch:e=>e(t)}),g=t=>{try{return e=t(),{map:t=>g((()=>t(e))),fold:(t,s)=>s(e),catch:()=>{}}}catch(t){return m(t)}var e},v="context-request";class x extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(v,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const y="error",C=(t,e,s="debug")=>((t=>"warn"===t||t===y)(s)&&console[s](e,t),t),E=t=>s(t)?E(t()):t,M=t=>t.shadowRoot||t;class k extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){g((()=>!this.registry.get(t)&&this.registry.define(t,this))).catch((e=>C(t,e.message,y)))}#t=new Map;attributeChangedCallback(t,e,n){if(n===e)return;const o=this.constructor.attributeMap[t];this.set(t,s(o)?o(i(n),this,e).fold((()=>{}),(t=>t)):n)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new x(t,(e=>this.set(String(t),e))))}));const n=t.providedContexts||[];n.length&&this.addEventListener(v,(t=>{const{context:e,callback:o}=t;n.includes(e)&&s(o)&&(t.stopPropagation(),o(this.#t.get(String(e))))}))}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return E(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);f(s)&&s.set(e)}}else this.#t.set(t,h(e)?e:p(e))}delete(t){return this.#t.delete(t)}first(t){return i(M(this).querySelector(t)).fold((()=>{}),(t=>l(this,t)))}all(t){return Array.from(M(this).querySelectorAll(t)).map((t=>l(this,t)))}async pass(t,e){if(await this.constructor.registry.whenDefined(t.localName),o(t,"set"))for(const[n,o]of Object.entries(e))t.set(n,h(o)?o:s(o)?p(o):this.#t.get(o));else C(t,"Expected UIElement",y)}signal(t){return this.#t.get(t)}}const w=t=>async(e,n)=>{if(await e.constructor.registry.whenDefined(n.localName),o(n,"set"))for(const[o,c]of Object.entries(t))n.set(o,h(c)?c:s(c)?p(c):e.signal(c));else C(n,"Expected UIElement",y)},S=t=>Number.isFinite(t)?t:void 0,N=t=>i(t.fold((()=>!1),(()=>!0))),A=t=>t.map((t=>parseInt(t,10))).map(S),L=t=>t.map(parseFloat).map(S),O=t=>t,T=t=>t.map((t=>g((()=>JSON.parse(t))).fold((t=>C(void 0,`Failed to parse JSON: ${t.message}`,y)),(t=>t)))),j=(t,e,s)=>(n,o)=>{const c=t=>i(s(t)).map((t=>n.set(e,t)));return o.addEventListener(t,c),()=>o.removeEventListener(t,c)},q=(t,e,s,n,o,c)=>{const r=d(o);t.set(e,n,!1),b((n=>{t.has(e)&&i(t.get(e)).fold((()=>n(s,r)),(t=>n(s,(t=>d(c(t)))(t))))}))},D=t=>(e,s)=>{const n=s.textContent||"",o=t=>()=>{Array.from(s.childNodes).filter(c).forEach((t=>t.remove())),s.append(document.createTextNode(t))};q(e,t,s,n,o(n),o)},F=(t,e=t)=>(s,n)=>{const o=e=>()=>n[t]=e;q(s,e,n,n[t],o(null),o)},I=(t,e=t)=>(s,n)=>{q(s,e,n,n.getAttribute(t),(()=>n.removeAttribute(t)),(e=>()=>n.setAttribute(t,e)))},H=(t,e=t)=>(s,n)=>{const o=e=>()=>n.toggleAttribute(t,e);q(s,e,n,n.hasAttribute(t),o(!1),o)},J=(t,e=t)=>(s,n)=>{q(s,e,n,n.classList.contains(t),(()=>n.classList.remove(t)),(e=>()=>n.classList.toggle(t,e)))},P=(t,e=t)=>(s,n)=>{(t=>{for(const e of[HTMLElement,SVGElement,MathMLElement])if(t instanceof e)return!0;return!1})(n)?q(s,e,n,n.style[t],(()=>n.style.removeProperty(t)),(e=>()=>n.style[t]=String(e))):C(n,"The target element is not styleable")},U=(t,e={},o,c=k)=>{const r=class extends c{static observedAttributes=n(e.attributeMap)?Object.keys(e.attributeMap):[];static attributeMap=e.attributeMap||{};static providedContexts=e.providedContexts||[];static consumedContexts=e.consumedContexts||[];disconnect;connectedCallback(){if(super.connectedCallback(),!s(o))return;const t=o(this);s(t)&&(this.disconnect=t)}disconnectedCallback(){"disconnectedCallback"in c&&super.disconnectedCallback(),this.disconnect()}};return r.define(t),r};export{k as UIElement,N as asBoolean,A as asInteger,T as asJSON,L as asNumber,O as asString,U as component,b as effect,d as io,i as maybe,j as on,w as pass,I as syncAttr,H as syncBool,J as syncClass,F as syncProp,P as syncStyle,D as syncText,l as ui};
