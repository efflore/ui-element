const t=t=>e=>typeof e===t,e=t("object"),s=t("function"),n=t=>null!=t,o=t=>n(t)&&(e(t)||s(t)),r=(t,e)=>s(t[e]),c=t=>t.nodeType!==Node.COMMENT_NODE,a=()=>new Proxy({},{get:(t,e)=>"toString"===e?()=>"":"fold"===e?t=>t():()=>a()}),i=t=>({map:e=>i(e(t)),fold:(e,s)=>s(t),toString:()=>String(t)}),l=t=>(t=>null==t)(t)?a():i(t);let d;const u=t=>o(t)&&r(t,"set"),f=t=>u(t)||(t=>o(t)&&r(t,"run")&&"effects"in t)(t),h=t=>{const e=()=>(d&&e.effects.add(d),t);return e.effects=new Set,e.set=n=>{const o=t;t=s(n)&&!f(n)?n(t):n,Object.is(t,o)||(t=>{for(const e of t)e.run()})(e.effects)},e},p=t=>{const e=new Map,n=()=>{const o=d;d=n;const r=t(((t,s)=>{e.has(t)||e.set(t,new Set),e.get(t)?.add(s)}));for(const t of e.values()){for(const e of t)e();t.clear()}d=o,s(r)&&queueMicrotask(r)};n.run=()=>n(),n.targets=e,n()},b=t=>({map:()=>b(t),fold:e=>e(t),catch:e=>e(t)}),m=t=>{try{return e=t(),{map:t=>m((()=>t(e))),fold:(t,s)=>s(e),catch:()=>{}}}catch(t){return b(t)}var e},g="context-request";class x extends Event{context;callback;subscribe;constructor(t,e,s=!1){super(g,{bubbles:!0,composed:!0}),this.context=t,this.callback=e,this.subscribe=s}}const v="error",y=(t,e,s="debug")=>((t=>"warn"===t||t===v)(s)&&console[s](e,t),t),C=t=>s(t)?C(t()):t;class E extends HTMLElement{static registry=customElements;static attributeMap={};static consumedContexts;static providedContexts;static define(t){m((()=>!this.registry.get(t)&&this.registry.define(t,this))).catch((e=>y(t,e.message,v)))}#t=new Map;attributeChangedCallback(t,e,n){if(n===e)return;const o=this.constructor.attributeMap[t];this.set(t,s(o)?o(l(n),this,e).fold((()=>{}),(t=>t)):n)}connectedCallback(){const t=this.constructor,e=t.consumedContexts||[];for(const t of e)this.set(String(t),void 0);setTimeout((()=>{for(const t of e)this.dispatchEvent(new x(t,(e=>this.set(String(t),e))))}));const n=t.providedContexts||[];n.length&&this.addEventListener(g,(t=>{const{context:e,callback:o}=t;n.includes(e)&&s(o)&&(t.stopPropagation(),o(this.#t.get(String(e))))}))}disconnectedCallback(){}has(t){return this.#t.has(t)}get(t){return C(this.#t.get(t))}set(t,e,s=!0){if(this.#t.has(t)){if(s){const s=this.#t.get(t);u(s)&&s.set(e)}}else this.#t.set(t,f(e)?e:h(e))}delete(t){return this.#t.delete(t)}async pass(t,e){if(await this.constructor.registry.whenDefined(t.localName),r(t,"set"))for(const[n,o]of Object.entries(e))t.set(n,f(o)?o:s(o)?h(o):this.#t.get(o));else y(t,"Expected UIElement",v)}signal(t){return this.#t.get(t)}}const M=t=>Number.isFinite(t)?t:void 0,S=t=>l(t.fold((()=>!1),(()=>!0))),k=t=>t.map((t=>parseInt(t,10))).map(M),w=t=>t.map(parseFloat).map(M),A=t=>t,N=t=>t.map((t=>m((()=>JSON.parse(t))).fold((t=>y(void 0,`Failed to parse JSON: ${t.message}`,v)),(t=>t)))),L=(t,e)=>{const s=()=>t;s.map=s=>L(s(t,e),e),s.on=(e,s)=>(t.addEventListener(e,s),()=>t.removeEventListener(e,s));const o=(n,o,r)=>(e.set(n,o,!1),p((s=>e.has(n)&&s(t,(()=>r(e.get(n),o))))),s);if(s.text=e=>o(e,t.textContent||"",((e,s)=>{Array.from(t.childNodes).filter(c).forEach((t=>t.remove())),t.append(document.createTextNode(n(e)?e:s))})),s.prop=(e,s=e)=>o(s,t[e],(s=>t[e]=s)),s.attr=(e,s=e)=>o(s,t.getAttribute(e),(s=>n(s)?t.setAttribute(e,String(s)):t.removeAttribute(e))),s.bool=(e,s=e)=>o(s,t.hasAttribute(e),(s=>t.toggleAttribute(e,s))),s.class=(e,s=e)=>o(s,t.classList.contains(e),(s=>t.classList[s?"add":"remove"](e))),(t=>{for(const e of[HTMLElement,SVGElement,MathMLElement])if(t instanceof e)return!0;return!1})(t)&&(s.style=(e,s=e)=>o(s,t.style[e],(s=>n(s)?t.style[e]=String(s):t.style.removeProperty(e)))),e===t){const t=e.shadowRoot||e;s.first=s=>{const n=t.querySelector(s);return n?L(n,e):l(null)},s.all=s=>Array.from(t.querySelectorAll(s)).map((t=>L(t,e)))}return s},O=(t,e={},n,r=E)=>{const c=class extends r{static observedAttributes=o(e.attributeMap)?Object.keys(e.attributeMap):[];static attributeMap=e.attributeMap||{};static providedContexts=e.providedContexts||[];static consumedContexts=e.consumedContexts||[];disconnect;connectedCallback(){if(super.connectedCallback(),!s(n))return;const t=n(this,L(this,this));s(t)&&(this.disconnect=t)}disconnectedCallback(){"disconnectedCallback"in r&&super.disconnectedCallback(),this.disconnect()}};return c.define(t),c};export{S as asBoolean,k as asInteger,N as asJSON,w as asNumber,A as asString,O as component,E as default,p as effect,l as maybe,L as ui};
